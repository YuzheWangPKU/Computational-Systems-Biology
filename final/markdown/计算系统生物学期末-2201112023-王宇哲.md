
# <center>Computational Systems Biology, Final Exam
<center>ç‹å®‡å“² 2201112023
<center>Academy for Advanced Interdisciplinary Studies, Peking University

## 1. ç±³æ°é…¶åŠ¨åŠ›å­¦ (Michalis-Menten Kinetics)

æ ¹æ®ä»¥ä¸‹ååº”æœºç†ï¼Œå˜æ„é…¶$E$ä¸åº•ç‰©$S$ååº”ç”Ÿæˆäº§ç‰©Pï¼š
$$
\begin{aligned}
S + E & \xrightleftharpoons[k_{-1}]{k_{1}} C_1\xrightarrow{k_2} E+P \\
S + C_1 & \xrightleftharpoons[k_{-3}]{k_{3}} C_2\xrightarrow{k_4} C_1+P \\
\end{aligned}\tag{1}
$$
å…¶ä¸­$k$æ˜¯é€Ÿç‡å¸¸æ•°å¹¶ä¸”$C_1$å’Œ$C_2$æ˜¯é…¶-åº•ç‰©å¤åˆç‰©ã€‚ç”¨å°å†™å­—æ¯è¡¨ç¤ºæµ“åº¦ï¼Œåˆå§‹æ¡ä»¶ä¸º$s(0)=s_0,\, e(0)=e_0,\,C_1(0)=C_2(0)=0$, è¯·æ ¹æ®è´¨é‡ä½œç”¨å®šå¾‹å†™å‡ºå¾®åˆ†æ–¹ç¨‹æ¨¡å‹ã€‚

***Proof.*** æ ¹æ®è´¨é‡ä½œç”¨å®šå¾‹ï¼Œå¾®åˆ†æ–¹ç¨‹æ¨¡å‹ä¸ºï¼š
$$
\begin{aligned}
\frac{ds}{dt} &= -k_1se+k_{-1}c_1-k_3sc_1+k_{-3}c_2 \\
\frac{de}{dt} &= -k_1se+k_{-1}c_1+k_2c_1 \\
\frac{dc_1}{dt} &=  k_1se-k_{-1}c_1-k_2c_1-k_3sc_1+k_{-3}c_2+k_4c_2\\
\frac{dc_2}{dt} &=  k_3sc_1-k_{-3}c_2-k_4c_2\\
\frac{dp}{dt} &=  k_2c_1+k_4c_2\\
\end{aligned}\tag{2}
$$

å¦‚æœ
$$
\begin{aligned}
&\varepsilon=\frac{e_0}{s_0}\ll 1\\
&\tau=k_1e_0t\\
&u=\frac{s}{s_0}\\ 
&v_i=\frac{c_i}{e_0}
\end{aligned}\tag{3}
$$
æ— é‡çº²åŒ–åçš„ååº”æ–¹ç¨‹ä¸ºå¦‚ä¸‹å½¢å¼ï¼š
$$
\begin{aligned}
\frac{du}{d\tau}&=f(u,v_1,v_2) \\
\varepsilon\frac{dv_i}{d\tau}&=g_i(u,v_1,v_2),\,i=1,2 \\
\end{aligned}\tag{4}
$$
è¯·å†™å‡º$f,g_1,g_2$çš„å…·ä½“å½¢å¼ï¼Œå¹¶ä¸”æ¨åˆ°å½“$\tau\gg\varepsilon$æ—¶ï¼Œ$u$çš„å˜åŒ–ç”±ä»¥ä¸‹æ–¹ç¨‹æ‰€å†³å®šï¼š
$$
\frac{du}{d\tau}=-r(u)=-u\frac{A+Bu}{C+u+Du^2}\tag{5}
$$
å…¶ä¸­$A,B,C,D$æ˜¯æ­£å‚æ•°ã€‚

***Proof.*** å¯¹(2)å¼è¿›è¡Œæ— é‡çº²åŒ–ï¼Œè€ƒè™‘
$$
e_0=e+c_1+c_2\tag{6}
$$
å¾—åˆ°
$$
\begin{aligned}
\frac{du}{d\tau}&=-u+\Big(u-\frac{k_3}{k_1}u+\frac{k_{-1}}{k_1s_0}\Big)v_1+\Big(u+\frac{k_{-3}}{k_1s_0}\Big)v_2\\
\varepsilon\frac{dv_1}{d\tau}&=u-\Big(u+\frac{k_3}{k_1}u+\frac{k_{-1}+k_2}{k_1s_0}\Big)v_1-\Big(u-\frac{k_{-3}+k_4}{k_1s_0}\Big)v_2\\
\varepsilon\frac{dv_2}{d\tau}&=\frac{k_3}{k_1}uv_1-\frac{k_{-3}+k_4}{k_1s_0}v_2\\
\end{aligned}\tag{7}
$$
ä¹Ÿå³
$$
\begin{aligned}
f(u,v_1,v_2)&=-u+\Big(u-\frac{k_3}{k_1}u+\frac{k_{-1}}{k_1s_0}\Big)v_1+\Big(u+\frac{k_{-3}}{k_1s_0}\Big)v_2\\
g_1(u,v_1,v_2)&=u-\Big(u+\frac{k_3}{k_1}u+\frac{k_{-1}+k_2}{k_1s_0}\Big)v_1-\Big(u-\frac{k_{-3}+k_4}{k_1s_0}\Big)v_2\\
g_2(u,v_1,v_2)&=\frac{k_3}{k_1}uv_1-\frac{k_{-3}+k_4}{k_1s_0}v_2\\
\end{aligned}\tag{8}
$$
å½“$\tau\gg \varepsilon$æ—¶ï¼Œå¯ä»¥è®¤ä¸º
$$
\begin{aligned}
g_1(u,v_1,v_2)&=0\\
g_2(u,v_1,v_2)&=0\\
\end{aligned}\tag{9}
$$
æ•…
$$
\begin{aligned}
\frac{du}{d\tau}&=-\frac{k_2}{k_1s_0}v_1-\frac{k_4}{k_1s_0}v_2\\
&=-\Big(\frac{k_3k_4}{k_1(k_{-3}+k_4)}u+\frac{k_2}{k_1s_0}\Big)v_1\\
&=-u\frac{\frac{k_2}{k_1s_0}+\frac{k_3k_4}{k_1(k_{-3}+k_4)}u}{\frac{k_{-1}+k_2}{k_1s_0}+u+\frac{k_3s_0}{k_{-3}+k_4}u^2}\\
&\equiv -u\frac{A+Bu}{C+u+Du^2}\\
&\equiv -r(u)\\
\end{aligned}\tag{10}
$$
å…¶ä¸­$A,B.C,D$ä¸ºæ­£å¸¸æ•°ï¼Œå³å¾—åˆ°(5)å¼ã€‚

å½“$k_2=0$æ—¶ï¼Œç”»å‡ºååº”é€Ÿç‡$r(u)$ä½œä¸º$u$çš„å‡½æ•°çš„è‰å›¾ï¼Œå¹¶ä¸”å°†å…¶ä¸Michaelis-Mentené€Ÿç‡è¿›è¡Œæ¯”è¾ƒã€‚

***Proof.*** å½“$k_2=0$æ—¶ï¼Œååº”é€Ÿç‡
$$
r(u)=\frac{Bu^2}{C+u+Du^2}\tag{11}
$$
ä½¿ç”¨å¦‚ä¸‹Pythonä»£ç ç”»å‡º$r(u)$çš„è‰å›¾å¦‚ä¸‹ï¼Œå¹¶ç”»å‡ºå…¸å‹çš„Michaelis-Mentené€Ÿç‡ä½œä¸ºæ¯”è¾ƒã€‚å¯è§$r(u)$å…·æœ‰Så‹æ›²çº¿çš„å½¢å¼ã€‚


```python
import numpy as np
import matplotlib.pyplot as plt

B = 1
C = 5
D = 1

def r(u, B=B, C=C, D=D):
    return (B * u**2) / (C + u + D * u**2)

def MM(u, K=1, V=1):
    return (V * u) / (K + u)


u_values = np.linspace(0, 10, 100)
r_values = r(u_values)
MM_values = MM(u_values)

fig, ax = plt.subplots()
plt.rcParams.update({
    "text.usetex": True
    })


ax.plot(u_values, r_values, label='$r(u)$')
ax.plot(u_values, MM_values, label='$\\rm Michaelis-Menten$')
ax.set_xlabel('$u$')
ax.set_ylabel('$r(u)$')
ax.set_title('Plot of $r(u)$ vs. Michaelis-Menten Dynamics')
plt.legend()

fig.set_size_inches(8, 6)
plt.savefig('1.jpg', dpi=1000, bbox_inches='tight')
plt.show()
```

<img src="1.jpg" alt="jpg" style="zoom:7%;" />


## 2. è‡ªæŠ‘åˆ¶ä¸­çš„æŒ¯è¡ (Oscillation in Self-Inhibition)

å‡è®¾ä¸€ç§è›‹ç™½è´¨æŠ‘åˆ¶å…¶è‡ªèº«çš„è¡¨è¾¾ï¼Œä½¿å¾—æè¿°è›‹ç™½è´¨æµ“åº¦$p$çš„å¾®åˆ†æ–¹ç¨‹ä¸º:
$$
\dot{p}=\frac{\alpha}{1+p^n}-p\tag{12}
$$
åœ¨ä»€ä¹ˆå‚æ•°èŒƒå›´å†…ï¼Œè¿™ç§è‡ªæˆ‘æŠ‘åˆ¶ä¼šå¯¼è‡´æŒ¯è¡ï¼Ÿå¹³è¡¡ç‚¹æ˜¯ç¨³å®šçš„è¿˜æ˜¯ä¸ç¨³å®šçš„ï¼Ÿ


***Proof.*** å¹³è¡¡ç‚¹$p_0$æ»¡è¶³
$$
\frac{\alpha}{1+p_0^n}-p_0=0\tag{13}
$$
ä»¤$\dot{p}=f(p)$ï¼Œè®¡ç®—
$$
f'(p_0)=-\frac{n\alpha p_0^{n-1}}{(1+p_0^n)^2}-1=-\frac{np_0^{n+1}}{\alpha}-1<0\tag{14}
$$
å› æ­¤è¿™ç§è‡ªæˆ‘æŠ‘åˆ¶ä¸å¯èƒ½äº§ç”ŸæŒ¯è¡ï¼Œå¹³è¡¡ç‚¹æ˜¯ç¨³å®šå¹³è¡¡ç‚¹ã€‚

a. ç°åœ¨è€ƒè™‘ä¸€ä¸ªç¨å¾®å¤æ‚ä¸€ç‚¹çš„æ¨¡å‹ï¼Œæˆ‘ä»¬ç›´æ¥ç”¨å®ƒæ¥æ¨¡æ‹Ÿè½¬å½•:
$$
\begin{aligned}
\dot{m}&=\frac{\alpha}{1+p^n}-m\\
\dot{p}&=-\beta(p-m)
\end{aligned}\tag{15}
$$
è¿™ç»„æ–¹ç¨‹çš„ä¸åŠ¨ç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ

***Proof.*** æ–¹ç¨‹(15)çš„å¹³è¡¡ç‚¹$(m_0,p_0)$æ»¡è¶³
$$
\begin{aligned}
\frac{\alpha}{1+p_0^n}-m_0&=0\\
-\beta(p_0-m_0)&=0\\
\end{aligned}\tag{16}
$$
ä¹Ÿå³
$$
m_0=p_0=\frac{\alpha}{1+p_0^n}\tag{17}
$$

b. ä½¿ç”¨çº¿æ€§ç¨³å®šæ€§åˆ†ææ¥è®¡ç®—ä½¿å¾—è¿™ä¸ªå¹³è¡¡ç‚¹å˜å¾—ä¸ç¨³å®šï¼Œäº§ç”ŸæŒ¯è¡çš„æ¡ä»¶ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ã€‚

***Proof.*** è®¡ç®—(15)çš„JacobiançŸ©é˜µ
$$
J=\begin{bmatrix}
-1 &-\frac{n\alpha p^{n-1}}{(1+p^n)^2}\\
\beta&-\beta\\
\end{bmatrix}\tag{18}
$$
å› æ­¤
$$
\begin{aligned}
\text{Tr}(J)&=-1-\beta<0\\
\det(J)&=\beta+\beta\frac{n\alpha p^{n-1}}{(1+p^n)^2}>0\\
\end{aligned}\tag{19}
$$
å› æ­¤å¹³è¡¡ç‚¹$(m_0,p_0)$ä¸ºç¨³å®šå¹³è¡¡ç‚¹ï¼Œæ— æ³•äº§ç”ŸæŒ¯è¡ã€‚

c. å¦‚ä½•ä¿®æ”¹è¿™ä¸ªæ¨¡å‹ä»¥å¢å¼ºäº§ç”ŸæŒ¯è¡çš„èƒ½åŠ›ï¼Ÿ

***Proof.*** ä¸ºäº§ç”ŸæŒ¯è¡ï¼Œéœ€è¦ä¿®æ”¹æ¨¡å‹ä½¿å¾—è›‹ç™½è´¨$p$ä¿ƒè¿›è‡ªèº«çš„è¡¨è¾¾ï¼Œå³
$$
\begin{aligned}
\dot{m}&=\frac{\alpha}{1+p^n}-m\\
\dot{p}&=-\beta (p-m)+\gamma p^2
\end{aligned}\tag{20}
$$
ä¿®æ”¹å(20)çš„JacobiançŸ©é˜µä¸º
$$
J'=\begin{bmatrix}
-1 &-\frac{n\alpha p^{n-1}}{(1+p^n)^2}\\
\beta&-\beta+2\gamma p\\
\end{bmatrix}\tag{21}
$$
è€ƒè™‘å¹³è¡¡ç‚¹ä¸º$(m_0,p_0)$ï¼Œå½“å‚æ•°$n,\gamma,\beta$æ»¡è¶³
$$
\text{Tr}(J')=-1-\beta+2\gamma p_0>0\tag{22}
$$
æˆ–
$$
\det(J')=\beta+\beta\frac{n\alpha p^{n-1}}{(1+p^n)^2}-2\gamma p_0<0\tag{23}
$$
æ—¶ï¼Œæ¨¡å‹å¯èƒ½äº§ç”ŸæŒ¯è¡ã€‚

## 3. ä¸»æ–¹ç¨‹ (Master Equation)

è€ƒè™‘ä»¥ä¸‹çš„è´Ÿè‡ªè°ƒæ§æ¨¡å‹
$$
\dot{n}=\frac{\beta K}{K+n}-\alpha n\tag{24}
$$
å…¶ä¸­$n$æ˜¯ç»†èƒä¸­è›‹ç™½è´¨çš„æ•°é‡ï¼Œ$K$æ˜¯å¯åŠ¨å­å¤„äºåŠæ•°è¢«æŠ‘åˆ¶æ—¶å€™è›‹ç™½è´¨çš„æ•°é‡ã€‚

a. ä½¿ç”¨ä¸»æ–¹ç¨‹çš„å½¢å¼ï¼Œå†™å‡ºæœ‰$n$ä¸ªè›‹ç™½è´¨çš„æ¦‚ç‡éšæ—¶é—´å˜åŒ–çš„è¡¨è¾¾å¼ã€‚

***Proof.*** æ ¹æ®(24)ï¼Œè®°
$$
\begin{aligned}
f_n&=\frac{\beta K}{K+n}\\
g_n&=\alpha n\\
\end{aligned}\tag{25}
$$
ä¸»æ–¹ç¨‹ç»™å‡ºæœ‰$n$ä¸ªè›‹ç™½è´¨çš„æ¦‚ç‡$P_n$éšæ—¶é—´å˜åŒ–çš„è¡¨è¾¾å¼ä¸º
$$
\begin{aligned}
\frac{dP_n}{dt}&=-(f_n+g_n)P_n+f_{n-1}P_{n-1}+g_{n+1}P_{n+1}\\
&=-\Big(\frac{\beta K}{K+n}+\alpha n\Big)P_n+\frac{\beta K}{K+n-1}P_{n-1}+\alpha(n+1)P_{n+1}\\
\end{aligned}\tag{26}
$$

b. å‡è®¾$\beta= 1\,{\rm min^{-1}}$ï¼Œ$\alpha=0.1\,{\rm min^{-1}}$ï¼Œ$K=10$ã€‚å¦‚æœåœ¨æ—¶é—´$t=0$æ—¶ï¼Œç»†èƒçš„åˆå§‹çŠ¶æ€ä¸º$P(n=20)=0.5$ï¼Œ$P(n=21)=0.5$ï¼Œé‚£ä¹ˆåœ¨$\Delta t =0.01\,{\rm min}$åçŠ¶æ€çš„æ¦‚ç‡åˆ†å¸ƒæ˜¯ä»€ä¹ˆï¼Ÿä¿æŒæ‰€æœ‰é¡¹ä¸$\Delta t$åŒé˜¶ã€‚

***Proof.*** å„å‚æ•°ä»£å…¥(26)å¾—
$$
\begin{aligned}
\frac{dP_n}{dt}&=-\Big(\frac{10}{10+n}+0.1n\Big)P_n+\frac{10}{9+n}P_{n-1}+0.1(n+1)P_{n+1}\\
\end{aligned}\tag{27}
$$
ä½¿ç”¨å¦‚ä¸‹Pythonä»£ç æ¨¡æ‹Ÿæ¦‚ç‡åˆ†å¸ƒéšæ—¶é—´çš„æ¼”åŒ–ï¼Œå¾—åˆ°$\Delta t=0.01\,{\rm min}$åçŠ¶æ€çš„æ¦‚ç‡åˆ†å¸ƒï¼Œæ–¹ä¾¿èµ·è§ä»…å±•ç¤º$n=17\sim 24$ã€‚


```python
import numpy as np
import matplotlib.pyplot as plt

# Define the parameters
N = 41  # number of states
T = 0.01  # total time
dt = 0.00001  # time step
steps = int(T / dt)  # number of steps

# Initialize the probabilities
P = np.zeros(N)
P[20] = 0.5
P[21] = 0.5

# Define the rates
def rates(n):
    return 10 / (9 + n), -((10 / (10 + n)) + 0.1 * n), 0.1 * (n + 1)

# Time evolution
for t in range(steps):
    dP = np.zeros(N)
    for n in range(N):
        r_minus, r_0, r_plus = rates(n)
        dP[n] += r_0 * P[n]
        if n > 0:
            dP[n] += r_minus * P[n - 1]
        if n < N - 1:
            dP[n] += r_plus * P[n + 1]
    P += dt * dP

# Print the final probabilities for n = 17 to n = 25
for n in range(17, 26):
    print(f"P_{n} = {P[n]:.5f}")

# Plot the final probabilities
fig, ax = plt.subplots()
plt.rcParams.update({
    "text.usetex": True
    })

ax.bar(range(17, 25), P[17:25])
ax.set_xlabel('$n$')
ax.set_ylabel('$P_n$')
ax.set_title('Final probabilities for $n = 17\sim 24$')

fig.set_size_inches(8, 6)
plt.savefig('3.jpg', dpi=1000, bbox_inches='tight')
plt.show()
```

    P_17 = 0.00000
    P_18 = 0.00009
    P_19 = 0.00987
    P_20 = 0.49876
    P_21 = 0.48970
    P_22 = 0.00157
    P_23 = 0.00000
    P_24 = 0.00000
    P_25 = 0.00000

<img src="3.jpg" alt="jpg" style="zoom:7%;" />


c. è¶³å¤Ÿé•¿æ—¶é—´ä¹‹åï¼Œç³»ç»Ÿè¾¾åˆ°å¹³è¡¡ï¼Œæ­¤æ—¶$\frac{P(n=20)}{P(n=21)}$çš„æ¯”ä¾‹æ˜¯å¤šå°‘ï¼Ÿ

***Proof.*** ä½¿ç”¨å¦‚ä¸‹Pythonä»£ç æ¨¡æ‹Ÿè¶³å¤Ÿé•¿æ—¶é—´å†…æ¦‚ç‡åˆ†å¸ƒéšæ—¶é—´çš„æ¼”åŒ–ï¼Œç›´è‡³ç³»ç»Ÿè¾¾åˆ°å¹³è¡¡ã€‚


```python
import numpy as np

# Define the parameters
N = 1001  # number of states
beta = 1  # adjust as needed
alpha = 0.1  # adjust as needed
K = 10  # adjust as needed

# Initialize the system of equations
A = np.zeros((N, N))
b = np.zeros(N)

# Define the rates
def rates(n):
    return (beta * K) / (K + n - 1), -((beta * K) / (K + n) + alpha * n), alpha * (n + 1)

# Build the system of equations
for n in range(N):
    r_minus, r_0, r_plus = rates(n)
    A[n, n] = r_0
    if n > 0:
        A[n, n - 1] = r_minus
    if n < N - 1:
        A[n, n + 1] = r_plus

# Adjust the last equation to ensure that the probabilities sum to 1
A[-1, :] = 1
b[-1] = 1

# Solve the system of equations
P = np.linalg.solve(A, b)

# Print the steady state probabilities
print(f"{P[20]/P[21]:.5f}")
```

    6.30000


å› æ­¤ç³»ç»Ÿè¾¾åˆ°å¹³è¡¡æ—¶ï¼Œ$\frac{P(n=20)}{P(n=21)}\simeq 6.3000$ã€‚

## 4. éšæœºååº” (Stochastic Reactions)

è€ƒè™‘ä¸€ä¸ªè›‹ç™½è´¨è½¬åŒ–é…¶ï¼Œå®ƒå¯ä»¥$k_{\rm suc}=10\,{\rm sec^{-1}}$çš„é€Ÿç‡æ°´è§£ä¸€ä¸ªè”—ç³–åˆ†å­ï¼ˆsucroseï¼‰æˆ–è€…$k_{\rm raff}=2\,{\rm sec^{-1}}$çš„é€Ÿç‡æ°´è§£ä¸€ä¸ªæ£‰å­ç³–åˆ†å­ï¼ˆraffinoseï¼‰ã€‚

a. æ¯ç§åŒ–å­¦ååº”å‘ç”Ÿçš„æ—¶é—´æ¦‚ç‡å¯†åº¦å‡½æ•°$p(t_i)$æ˜¯ä»€ä¹ˆï¼Ÿè¯·åœ¨åŒä¸€å›¾ä¸Šç»˜åˆ¶ä¸¤ä¸ªæ¦‚ç‡å¯†åº¦å‡½æ•°ï¼Œå¹¶åœ¨$x$è½´ä¸Šæ ‡è®°ç›¸å…³çš„æ—¶é—´å°ºåº¦ã€‚

***Proof.*** åŒ–å­¦ååº”$i$å‘ç”Ÿçš„æ—¶é—´æ¦‚ç‡å¯†åº¦å‡½æ•°ä¸º
$$
p_i(t)=k_i e^{-k_i t}\tag{28}
$$
ä½¿ç”¨å¦‚ä¸‹çš„Pythonä»£ç ç»˜åˆ¶ä¸¤ä¸ªæ¦‚ç‡å¯†åº¦å‡½æ•°å¦‚ä¸‹ã€‚


```python
import numpy as np
import matplotlib.pyplot as plt

def p_i(t, k_i):
    return k_i * np.exp(-k_i * t)

t_arr = np.linspace(0, 2, 100)

fig, ax = plt.subplots()
plt.rcParams.update({
    "text.usetex": True
    })

ax.plot(t_arr, p_i(t_arr, k_i=10), label='$\\rm sucrose$')
ax.plot(t_arr, p_i(t_arr, k_i=2), label='$\\rm raffinose$')
ax.set_xlabel('$t/{\\rm sec}$')
ax.set_ylabel('$p_i(t)$')
ax.set_title('Plot of $p_i(t)$ for sucrose and raffinose')
plt.legend()

fig.set_size_inches(8, 6)
plt.savefig('4-a.jpg', dpi=1000, bbox_inches='tight')
plt.show()
```

<img src="4-a.jpg" alt="jpg" style="zoom:7%;" />


b. æ¯ä¸ªåŒ–å­¦ååº”çš„ç´¯ç§¯æ¦‚ç‡åˆ†å¸ƒ$P(t)$æ˜¯ä»€ä¹ˆï¼Ÿ$P(t)$å®šä¹‰ä¸ºååº”åœ¨æ—¶é—´$t$å‰å‘ç”Ÿçš„æ¦‚ç‡ã€‚åŒæ ·ï¼Œè¯·åœ¨åŒä¸€å›¾ä¸Šç»˜åˆ¶ä¸¤ä¸ªç´¯ç§¯æ¦‚ç‡åˆ†å¸ƒï¼Œå¹¶æ ‡è®°$x$è½´å’Œ$y$è½´ã€‚

***Proof.*** å¯¹(28)ç§¯åˆ†å¾—
$$
P_i(t)=1-e^{-k_i t}\tag{29}
$$
ä½¿ç”¨å¦‚ä¸‹çš„Pythonä»£ç ç»˜åˆ¶ä¸¤ä¸ªç´¯ç§¯æ¦‚ç‡åˆ†å¸ƒå¦‚ä¸‹ã€‚


```python
import numpy as np
import matplotlib.pyplot as plt

def P_i(t, k_i):
    return 1 - np.exp(-k_i * t)

t_arr = np.linspace(0, 2, 100)

fig, ax = plt.subplots()
plt.rcParams.update({
    "text.usetex": True
    })

ax.plot(t_arr, P_i(t_arr, k_i=10), label='$\\rm sucrose$')
ax.plot(t_arr, P_i(t_arr, k_i=2), label='$\\rm raffinose$')
ax.set_xlabel('$t/{\\rm sec}$')
ax.set_ylabel('$P_i(t)$')
ax.set_title('Plot of $P_i(t)$ for sucrose and raffinose')
plt.legend()

fig.set_size_inches(8, 6)
plt.savefig('4-b.jpg', dpi=1000, bbox_inches='tight')
plt.show()
```

<img src="4-b.jpg" alt="jpg" style="zoom:7%;" />


c. è¿™ä¸¤ä¸ªååº”åœ¨æ—¶é—´$t$ä¹‹å‰éƒ½æ²¡æœ‰å‘ç”Ÿçš„æ¦‚ç‡æ˜¯å¤šå°‘ï¼Ÿ

***Proof.*** æ ¹æ®(29)ï¼Œä¸¤ä¸ªååº”åœ¨æ—¶é—´$t$ä¹‹å‰éƒ½æ²¡æœ‰å‘ç”Ÿçš„æ¦‚ç‡ä¸º
$$
P_{\rm none}(t)=\big(1-P_{\rm suc}(t)\big)\big(1-P_{\rm raff}(t)\big)=e^{-(k_{\rm suc}+k_{\rm raff})t}=e^{-12 t}\tag{30}
$$

d. ä¸¤ä¸ªååº”ä¸­ç¬¬ä¸€ä¸ªå‘ç”Ÿä¹‹å‰çš„æ¦‚ç‡å¯†åº¦å‡½æ•°æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•è§£é‡Šè¿™ä¸ªç»“æœã€‚

***Proof.*** å¯¹(30)è¿›è¡Œå½’ä¸€åŒ–ï¼Œå¾—åˆ°æ¦‚ç‡å¯†åº¦å‡½æ•°ä¸º
$$
p(t)=\frac{1}{k_{\rm suc}+k_{\rm raff}}e^{-(k_{\rm suc}+k_{\rm raff})t}=\frac{1}{12}e^{-12 t}\tag{31}
$$
è¯¥ç»“æœè¯´æ˜ä¸¤ä¸ªååº”ä¸­æœ‰ä¸€ä¸ªå‘ç”Ÿçš„Waiting timeæœä»å‚æ•°ä¸º$k_{\rm suc}+k_{\rm raff}$çš„æŒ‡æ•°åˆ†å¸ƒã€‚

e. å‰é¢çš„è®¡ç®—ä¸ºæ¨¡æ‹ŸéšæœºåŒ–å­¦åŠ¨åŠ›å­¦æä¾›äº†ä¸€ç§å¯èƒ½çš„æ–¹æ¡ˆã€‚å·²çŸ¥ç¬¬ä¸€ä¸ªååº”å‘ç”Ÿçš„æ¦‚ç‡åˆ†å¸ƒï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦ä¸€ç§æ–¹æ³•æ¥ä¼°è®¡å“ªä¸ªååº”å‘ç”Ÿäº†ã€‚è”—ç³–åœ¨æ£‰å­ç³–ä¹‹å‰æ°´è§£çš„æ¦‚ç‡æ˜¯å¤šå°‘ï¼Ÿ

***Proof.*** ä¼°è®¡å“ªä¸ªååº”å‘ç”Ÿï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹ç®—æ³•ï¼šç”Ÿæˆ$[0,1]$ä¸Šå‡åŒ€åˆ†å¸ƒçš„éšæœºå˜é‡$r$ï¼Œå¦‚æœ$r<\frac{k_{\rm suc}}{k_{\rm suc}+k_{\rm raff}}=0.8333$ï¼Œåˆ™è®¤ä¸ºè”—ç³–åœ¨æ£‰å­ç³–ä¹‹å‰æ°´è§£ï¼Œå¦åˆ™è®¤ä¸ºæ£‰å­ç³–åœ¨è”—ç³–ä¹‹å‰æ°´è§£ã€‚è”—ç³–åœ¨æ£‰å­ç³–ä¹‹å‰æ°´è§£çš„æ¦‚ç‡ä¸º$0.8333$ã€‚

## 5. è‡´ç—…æ€§è¿›åŒ– (Evolution of Virulence)

è€ƒè™‘ä¸€ç»„æ–¹ç¨‹æ¥æ¨¡æ‹Ÿè‡´ç—…æ€§çš„è¿›åŒ–ï¼Œå…¶ä¸­$ğ‘¥$æ˜¯æœªæ„ŸæŸ“çš„å®¿ä¸»æ•°é‡ï¼Œ$ğ‘¦_1$æ˜¯æ„ŸæŸ“å¯„ç”Ÿè™«1çš„å®¿ä¸»æ•°é‡ï¼Œ$ğ‘¦_2$æ˜¯æ„ŸæŸ“å¯„ç”Ÿè™«2çš„å®¿ä¸»æ•°é‡
$$
\begin{aligned}
\frac{dx}{dt}&=k-ux-x(\beta_1y_1+\beta_2y_2)\\
\frac{dy_1}{dt}&=y_1(\beta_1 x-u-v_1)\\
\frac{dy_2}{dt}&=y_2(\beta_2 x-u-v_2)
\end{aligned}\tag{32}
$$

a. åœ¨å¹³è¡¡çŠ¶æ€ä¸‹ï¼Œä¸¤ç§å¯„ç”Ÿè™«ä¸­é€šå¸¸åªæœ‰ä¸€ç§èƒ½å­˜æ´»ã€‚ä¸ºä»€ä¹ˆï¼Ÿ

***Proof.*** åœ¨å¹³è¡¡çŠ¶æ€ä¸‹ï¼Œæœ‰
$$
\begin{aligned}
\frac{dx}{dt}&=k-ux-x(\beta_1y_1+\beta_2y_2)=0\\
\frac{dy_1}{dt}&=y_1(\beta_1 x-u-v_1)=0\\
\frac{dy_2}{dt}&=y_2(\beta_2 x-u-v_2)=0
\end{aligned}\tag{33}
$$
é€šå¸¸$\beta_1 x-u-v_1$ä¸$\beta_2 x-u-v_2$ä¸åŒæ—¶ä¸º$0$ï¼Œå› æ­¤$y_1$ä¸$y_2$ä¸åŒæ—¶$>0$ï¼Œä¹Ÿå³ä¸¤ç§å¯„ç”Ÿè™«ä¸­é€šå¸¸åªæœ‰ä¸€ç§èƒ½å­˜æ´»ã€‚

b. é¦–å…ˆè€ƒè™‘æ²¡æœ‰å¯„ç”Ÿè™«2çš„æƒ…å†µä¸‹çš„åŠ¨æ€ã€‚æ‰¾åˆ°ç¬¬ä¸€ç§å¹³è¡¡ï¼ˆ$E_1$ï¼‰çš„è¡¨è¾¾å¼ï¼Œåœ¨è¯¥å¹³è¡¡ä¸‹å¯„ç”Ÿè™«1å­˜æ´»è€Œå¯„ç”Ÿè™«2ä¸å­˜æ´»ã€‚

***Proof.*** ç”±(33)ï¼Œå½“$y_2=0$æ—¶ï¼Œç¬¬ä¸€ç§å¹³è¡¡$E_1$æ»¡è¶³
$$
\begin{aligned}
x&=\frac{u+v_1}{\beta_1}\\
y_1&=\frac{k}{u+v_1}-\frac{u}{\beta_1}\\
y_2&=0
\end{aligned}\tag{34}
$$

c. å½“å¯„ç”Ÿè™«1çš„åŸºæœ¬ä¼ æŸ“æ•°ï¼ˆbasic reproductive ratioï¼‰$R_1$å¤§äº1æ—¶ï¼Œå¯„ç”Ÿè™«1ä¸ºåœ°æ–¹ç—…ï¼ˆéé›¶ï¼‰ã€‚$R_1$çš„è¡¨è¾¾å¼æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•è§£é‡Šå®ƒï¼Ÿ

***Proof.*** å¯„ç”Ÿè™«1çš„æœ¬åº•è¡¨è¾¾ç‡$R_1$ä¸º
$$
R_1=\frac{\beta_1}{u+v_1}\tag{35}
$$
å¯¹$R_1$è§£é‡Šå¦‚ä¸‹ï¼šåœ¨(32)ä¸­ï¼Œ$u$ä¸ºå®¿ä¸»çš„è‡ªç„¶æ­»äº¡ç‡ï¼Œ$v_i$ä¸ºæ„ŸæŸ“å¯„ç”Ÿè™«$i$é¢å¤–å¯¼è‡´çš„æ­»äº¡ç‡ï¼Œ$\beta_i$ä¸ºå¯„ç”Ÿè™«$i$çš„ä¼ æŸ“ç‡ï¼Œ$k$ä¸ºå®¿ä¸»çš„å‡ºç”Ÿç‡ã€‚$R_1$ä¸ºå¯„ç”Ÿè™«1çš„åŸºæœ¬ä¼ æŸ“æ•°ï¼Œå³1ä¸ªå¯„ç”Ÿè™«1çš„æ„ŸæŸ“è€…åœ¨å¥åº·çš„å®¿ä¸»ç§ç¾¤ä¸­å¹³å‡å¢åŠ äº†å¤šå°‘æ–°çš„æ„ŸæŸ“è€…ã€‚(35)å¼è®¡ç®—æ—¶ç”¨å¯„ç”Ÿè™«1çš„ä¼ æŸ“ç‡$\beta_1$é™¤ä»¥è‡ªç„¶æ­»äº¡ç‡$u$ä¸å¯„ç”Ÿè™«1é€ æˆçš„æ­»äº¡ç‡$v_1$ä¹‹å’Œï¼Œå¦‚æœ$R_1>1$ï¼Œè¯´æ˜æ¯ä¸ªæ„ŸæŸ“å¯„ç”Ÿè™«1çš„å®¿ä¸»å¹³å‡é€ æˆçš„äºŒæ¬¡æ„ŸæŸ“æ•°$>1$ï¼Œæ•…æ„ŸæŸ“å¯ä»¥åœ¨å®¿ä¸»ç§ç¾¤ä¸­ä¼ æ’­ã€‚

d. è¯·è¯æ˜å½“$R_2>R_1>1$æ—¶ï¼Œå¯„ç”Ÿè™«2å¯ä»¥å…¥ä¾µå¹³è¡¡1ï¼Œè€Œå¯„ç”Ÿè™«1ä¸èƒ½å…¥ä¾µå¹³è¡¡2ï¼ˆå½“å¯„ç”Ÿè™«2ä»¥éé›¶æ•°é‡å­˜åœ¨æ—¶ï¼‰ã€‚

***Proof.*** å½“$R_2>R_1>1$ï¼Œå³
$$
\frac{\beta_2}{u+v_2}>\frac{\beta_1}{u+v_1}>1\tag{36}
$$
æ—¶ï¼Œè€ƒè™‘åœ¨å¹³è¡¡$E_1$ä¸‹ï¼Œæ„ŸæŸ“å¯„ç”Ÿè™«2å®¿ä¸»æ•°é‡çš„å˜åŒ–ç‡
$$
\begin{aligned}
\frac{dy_2}{dt}&=y_2(\beta_2 x-u-v_2)\\
&=y_2\Big(\beta_2\frac{u+v_1}{\beta_1}-u-v_2\Big)\\
&=y_2\beta_2\Big(\frac{u+v_1}{\beta_1}-\frac{u+v_2}{\beta_2}\Big)\\
&>0
\end{aligned}\tag{37}
$$
å› æ­¤å¯„ç”Ÿè™«2å¯ä»¥å…¥ä¾µå¹³è¡¡1ã€‚åä¹‹ï¼Œè€ƒè™‘åœ¨å¹³è¡¡$E_2$ä¸‹ï¼Œæ„ŸæŸ“å¯„ç”Ÿè™«1å®¿ä¸»æ•°é‡çš„å˜åŒ–ç‡
$$
\begin{aligned}
\frac{dy_1}{dt}&=y_1(\beta_1 x-u-v_1)\\
&=y_1\Big(\beta_1\frac{u+v_2}{\beta_2}-u-v_1\Big)\\
&=y_1\beta_1\Big(\frac{u+v_2}{\beta_2}-\frac{u+v_1}{\beta_1}\Big)\\
&<0
\end{aligned}\tag{38}
$$
å› æ­¤å¯„ç”Ÿè™«1ä¸èƒ½å…¥ä¾µå¹³è¡¡2ã€‚

e. å½“$\beta_1=\alpha v_1$ï¼Œå¹¶ä¸”$\beta_2=\alpha v_2$æ—¶ï¼Œå…¶ä¸­$\alpha$æ˜¯å¸¸æ•°ï¼Œè‡´ç—…æ€§$v_i$å¦‚ä½•éšç€æ—¶é—´æ¼”åŒ–ï¼Ÿ

***Proof.*** å½“$\beta_1=\alpha v_1$ï¼Œå¹¶ä¸”$\beta_2=\alpha v_2$æ—¶ï¼Œ(32)å¼å˜ä¸º
$$
\begin{aligned}
\frac{dx}{dt}&=k-ux-x(\alpha v_1y_1+\alpha v_2y_2)\\
\frac{dy_1}{dt}&=y_1(\alpha v_1 x-u-v_1)\\
\frac{dy_2}{dt}&=y_2(\alpha v_2 x-u-v_2)
\end{aligned}\tag{39}
$$
è€ŒåŸºæœ¬ä¼ æŸ“æ•°å˜ä¸º
$$
\begin{aligned}
R_1&=\frac{\alpha v_1}{u+v_1}\\
R_2&=\frac{\alpha v_2}{u+v_2}
\end{aligned}\tag{40}
$$
$R_i$éš$v_i$å•è°ƒé€’å¢ï¼Œå› æ­¤åœ¨å¯„ç”Ÿè™«1ä¸å¯„ç”Ÿè™«2ç«äº‰çš„é€‰æ‹©å‹åŠ›ä¸‹ï¼Œè‡´ç—…æ€§$v_1$ï¼Œ$v_2$ä¼šå•è°ƒé€’å¢ã€‚ä½†ç”±äº$v_i\rightarrow \infty$, $R_i\rightarrow \alpha$ï¼Œå› æ­¤$v_1,v_2$å¢é•¿çš„é€‰æ‹©å‹åŠ›ä¼šè¶Šæ¥è¶Šå°ï¼Œå¢é•¿é€Ÿç‡è¶Šæ¥è¶Šæ…¢ã€‚
